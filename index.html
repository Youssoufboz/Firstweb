<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Tap Dodge</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">

<style>
html, body {
    margin: 0;
    padding: 0;
    background: #0f1220;
    overflow: hidden;
    font-family: Arial, sans-serif;
    touch-action: manipulation;
}

canvas {
    display: block;
}

#ui {
    position: fixed;
    top: 10px;
    width: 100%;
    text-align: center;
    color: white;
    font-size: 18px;
}

#gameOver {
    display: none;
    position: fixed;
    inset: 0;
    background: rgba(0,0,0,0.7);
    color: white;
    justify-content: center;
    align-items: center;
    flex-direction: column;
    font-size: 22px;
}
button {
    margin-top: 15px;
    padding: 12px 24px;
    font-size: 18px;
    border: none;
    border-radius: 8px;
}
</style>
</head>

<body>

<canvas id="game"></canvas>

<div id="ui">Score: <span id="score">0</span></div>

<div id="gameOver">
    <div>Game Over</div>
    <div>Score: <span id="finalScore"></span></div>
    <button onclick="restart()">Restart</button>
</div>

<script>
/* =========================
   SETUP
========================= */
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");

function resize() {
    canvas.width = innerWidth;
    canvas.height = innerHeight;
}
window.addEventListener("resize", resize);
resize();

/* =========================
   GAME STATE
========================= */
let running = true;
let score = 0;

const player = {
    x: canvas.width / 2,
    y: canvas.height - 120,
    size: 40,
    speed: 7
};

let obstacles = [];

/* =========================
   INPUT (PHONE ONLY)
========================= */
document.addEventListener("touchstart", e => {
    const x = e.touches[0].clientX;
    if (x < canvas.width / 2) {
        player.x -= player.speed * 10;
    } else {
        player.x += player.speed * 10;
    }
});

/* =========================
   SPAWN
========================= */
function spawnObstacle() {
    obstacles.push({
        x: Math.random() * (canvas.width - 40),
        y: -40,
        size: 40,
        speed: 4 + score * 0.05
    });
}
setInterval(spawnObstacle, 700);

/* =========================
   COLLISION
========================= */
function hit(a, b) {
    return (
        a.x < b.x + b.size &&
        a.x + a.size > b.x &&
        a.y < b.y + b.size &&
        a.y + a.size > b.y
    );
}

/* =========================
   LOOP
========================= */
function update() {
    if (!running) return;

    ctx.clearRect(0,0,canvas.width,canvas.height);

    // Player
    ctx.fillStyle = "#4cd137";
    ctx.fillRect(player.x, player.y, player.size, player.size);

    // Obstacles
    ctx.fillStyle = "#e84118";
    obstacles.forEach(o => {
        o.y += o.speed;
        ctx.fillRect(o.x, o.y, o.size, o.size);

        if (hit(player, o)) {
            endGame();
        }
    });

    // Cleanup
    obstacles = obstacles.filter(o => o.y < canvas.height + 50);

    // Score
    score++;
    document.getElementById("score").textContent = score;

    requestAnimationFrame(update);
}

update();

/* =========================
   GAME OVER
========================= */
function endGame() {
    running = false;
    document.getElementById("finalScore").textContent = score;
    document.getElementById("gameOver").style.display = "flex";
}

function restart() {
    score = 0;
    obstacles = [];
    player.x = canvas.width / 2;
    running = true;
    document.getElementById("gameOver").style.display = "none";
    update();
}
</script>

</body>
</html>